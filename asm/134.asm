
	.align	16
__MAIN
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,12
	sub	esp,4
	mov	eax,__DATA
	mov	[esp],eax
	call	__bbRestore
	sub	esp,4
	mov	eax,__LIBS
	mov	[esp],eax
	call	__bbLoadLibs
	call	_2_begin
	jmp	_2_leave
_2_begin
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	sub	esp,12
	mov	eax,_41
	mov	[esp],eax
	call	__bbStrConst
	mov	[esp],eax
	mov	[ebp-12],eax
	sub	esp,4
	mov	ebx,_42
	mov	[esp],ebx
	mov	eax,ebx
	call	__bbStrConst
	mov	ebx,eax
	mov	eax,[ebp-12]
	mov	[esp+4],ebx
	call	_fapptitle
	sub	esp,16
	mov	[esp+8],0
	mov	[esp+12],2
	mov	[esp+4],480
	mov	[esp],640
	call	_fgraphics
	sub	esp,8
	mov	eax,_43
	mov	[esp],eax
	call	__bbStrConst
	mov	[esp],eax
	call	_floadimage
	mov	[_vsourceimage],eax
	sub	esp,4
	mov	eax,_afloydsarray
	mov	[esp],eax
	call	__bbUndimArray
	mov	ebx,0
	mov	esi,_afloydsarray
	add	esi,12
	mov	[esi],ebx
	mov	ebx,0
	mov	esi,_afloydsarray
	add	esi,16
	mov	[esi],ebx
	sub	esp,4
	mov	eax,_afloydsarray
	mov	[esp],eax
	call	__bbDimArray
	call	_fmillisecs
	mov	[ebp-4],eax
	call	_fmillisecs
	mov	[ebp-8],eax
	sub	esp,16
	mov	eax,[_vdestinimage]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	mov	[ebp-12],eax
	sub	esp,4
	mov	ebx,_44
	mov	[esp],ebx
	mov	eax,ebx
	call	__bbStrConst
	mov	ebx,eax
	mov	eax,[ebp-12]
	mov	[esp+4],ebx
	call	_fsavebuffer
	sub	esp,4
	call	_ffrontbuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,16
	mov	[esp+8],20
	mov	[esp+12],0
	mov	[esp+4],0
	mov	eax,[_vdestinimage]
	mov	[esp],eax
	call	_fdrawblock
	sub	esp,16
	mov	[esp+8],20
	mov	[esp+12],0
	sub	esp,4
	mov	eax,[_vdestinimage]
	mov	[esp],eax
	call	_fimagewidth
	mov	[esp+4],eax
	mov	ebx,[_vsourceimage]
	mov	[esp],ebx
	mov	eax,ebx
	call	_fdrawblock
	mov	ebx,eax
	sub	esp,40
	mov	eax,_45
	mov	[esp],eax
	call	__bbStrConst
	mov	[esp],eax
	mov	[ebp-12],eax
	sub	esp,4
	mov	ebx,[ebp-8]
	sub	ebx,[ebp-4]
	mov	[esp],ebx
	mov	eax,ebx
	call	__bbStrFromInt
	mov	ebx,eax
	mov	eax,[ebp-12]
	mov	[esp+4],ebx
	call	__bbStrConcat
	mov	[esp],eax
	mov	[ebp-12],eax
	sub	esp,4
	mov	ebx,_46
	mov	[esp],ebx
	mov	eax,ebx
	call	__bbStrConst
	mov	ebx,eax
	mov	eax,[ebp-12]
	mov	[esp+4],ebx
	call	__bbStrConcat
	mov	[esp+8],eax
	mov	[esp+12],0
	mov	[esp+16],0
	mov	[esp+4],0
	mov	[esp],0
	call	_ftext
	call	_fwaitkey
	call	_fend
	ret
_2_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 0
	.align	16
_fimage_greyscale
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,40
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	mov	[ebp-40],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	[ebp-12],0
	jmp	_47
_48
	mov	[ebp-16],0
	jmp	_49
_50
	sub	esp,12
	mov	ebx,[ebp-16]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-20],eax
	mov	ebx,[ebp-20]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	[ebp-24],ebx
	mov	ebx,[ebp-20]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	[ebp-28],ebx
	mov	ebx,[ebp-20]
	mov	esi,255
	and	ebx,esi
	mov	[ebp-32],ebx
	mov	ebx,1050187929
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	esi,1058444951
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp-28]
	push	edi
	fild	[esp]
	pop	edi
	fmulp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	ebx,esi
	mov	esi,1038147809
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp-32]
	push	edi
	fild	[esp]
	pop	edi
	fmulp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	ebx,esi
	mov	[ebp-36],ebx
	mov	ebx,[ebp-36]
	mov	esi,[ebp-36]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-36]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_49
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_50
_5
	add	[ebp-12],1
_47
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_48
_4
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_3_leave
	mov	eax,0
	jmp	_3_leave
_3_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 4
	.align	16
_fimage_pixelate
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,60
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	mov	[ebp-40],ebx
	mov	[ebp-44],ebx
	mov	[ebp-48],ebx
	mov	[ebp-52],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	cmp	[ebp+32],1
	setnz	al
	movzx	eax,al
	mov	[ebp-56],eax
	cmp	[ebp+32],2
	mov	eax,ebx
	setnz	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-56]
	and	eax,ebx
	and	eax,eax
	jz	_51
	mov	[ebp+32],1
_51
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	ebx,[ebp+32]
	mov	[ebp-12],ebx
	cmp	[ebp-12],1
	jz	_53
	cmp	[ebp-12],2
	jz	_54
	jmp	_52
_53
	mov	[ebp-16],0
	jmp	_56
_55
	mov	[ebp-20],0
	jmp	_58
_57
	sub	esp,12
	mov	ebx,[ebp-20]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-16]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-24],eax
	mov	ebx,[ebp-24]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	[ebp-28],ebx
	mov	ebx,[ebp-24]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	[ebp-32],ebx
	mov	ebx,[ebp-24]
	mov	esi,255
	and	ebx,esi
	mov	[ebp-36],ebx
	mov	ebx,[ebp-36]
	mov	esi,[ebp-32]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-28]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	mov	[ebp-44],0
	jmp	_59
_60
	mov	[ebp-48],0
	jmp	_61
_62
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[ebp-56],eax
	sub	esp,4
	mov	ebx,[ebp-8]
	mov	[esp],ebx
	mov	eax,ebx
	call	_fimagewidth
	mov	ebx,eax
	mov	eax,[ebp-56]
	cmp	eax,ebx
	setl	al
	movzx	eax,al
	mov	[ebp-56],eax
	mov	ebx,[ebp-20]
	add	ebx,[ebp-48]
	mov	[ebp-60],eax
	sub	esp,4
	mov	esi,[ebp-8]
	mov	[esp],esi
	mov	eax,esi
	call	_fimageheight
	mov	esi,eax
	mov	eax,[ebp-60]
	cmp	ebx,esi
	mov	eax,ebx
	setl	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-56]
	and	eax,ebx
	and	eax,eax
	jz	_63
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-20]
	add	esi,[ebp-48]
	mov	[esp+4],esi
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[esp],eax
	call	_fwritepixelfast
_63
	add	[ebp-48],1
_61
	mov	ebx,[ebp+28]
	sub	ebx,1
	cmp	[ebp-48],ebx
	jle	_62
_11
	add	[ebp-44],1
_59
	mov	ebx,[ebp+24]
	sub	ebx,1
	cmp	[ebp-44],ebx
	jle	_60
_10
	mov	ebx,[ebp+28]
	add	[ebp-20],ebx
_58
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-20],eax
	jle	_57
_9
	mov	ebx,[ebp+24]
	add	[ebp-16],ebx
_56
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_55
_8
	jmp	_52
_54
	mov	[ebp-16],0
	jmp	_65
_64
	mov	[ebp-20],0
	jmp	_67
_66
	mov	[ebp-28],0
	mov	[ebp-32],0
	mov	[ebp-36],0
	mov	[ebp-52],0
	mov	[ebp-44],0
	jmp	_68
_69
	mov	[ebp-48],0
	jmp	_70
_71
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[ebp-56],eax
	sub	esp,4
	mov	ebx,[ebp-8]
	mov	[esp],ebx
	mov	eax,ebx
	call	_fimagewidth
	mov	ebx,eax
	mov	eax,[ebp-56]
	cmp	eax,ebx
	setl	al
	movzx	eax,al
	mov	[ebp-56],eax
	mov	ebx,[ebp-20]
	add	ebx,[ebp-48]
	mov	[ebp-60],eax
	sub	esp,4
	mov	esi,[ebp-8]
	mov	[esp],esi
	mov	eax,esi
	call	_fimageheight
	mov	esi,eax
	mov	eax,[ebp-60]
	cmp	ebx,esi
	mov	eax,ebx
	setl	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-56]
	and	eax,ebx
	and	eax,eax
	jz	_72
	sub	esp,12
	mov	ebx,[ebp-20]
	add	ebx,[ebp-48]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-24],eax
	mov	ebx,[ebp-24]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	add	[ebp-28],ebx
	mov	ebx,[ebp-24]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	add	[ebp-32],ebx
	mov	ebx,[ebp-24]
	mov	esi,255
	and	ebx,esi
	add	[ebp-36],ebx
	add	[ebp-52],1
_72
	add	[ebp-48],1
_70
	mov	ebx,[ebp+28]
	sub	ebx,1
	cmp	[ebp-48],ebx
	jle	_71
_15
	add	[ebp-44],1
_68
	mov	ebx,[ebp+24]
	sub	ebx,1
	cmp	[ebp-44],ebx
	jle	_69
_14
	mov	eax,[ebp-28]
	mov	ecx,[ebp-52]
	cdq
	idiv	ecx
	mov	[ebp-28],eax
	mov	eax,[ebp-32]
	mov	ecx,[ebp-52]
	cdq
	idiv	ecx
	mov	[ebp-32],eax
	mov	eax,[ebp-36]
	mov	ecx,[ebp-52]
	cdq
	idiv	ecx
	mov	[ebp-36],eax
	mov	ebx,[ebp-36]
	mov	esi,[ebp-32]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-28]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	mov	[ebp-44],0
	jmp	_73
_74
	mov	[ebp-48],0
	jmp	_75
_76
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[ebp-56],eax
	sub	esp,4
	mov	ebx,[ebp-8]
	mov	[esp],ebx
	mov	eax,ebx
	call	_fimagewidth
	mov	ebx,eax
	mov	eax,[ebp-56]
	cmp	eax,ebx
	setl	al
	movzx	eax,al
	mov	[ebp-56],eax
	mov	ebx,[ebp-20]
	add	ebx,[ebp-48]
	mov	[ebp-60],eax
	sub	esp,4
	mov	esi,[ebp-8]
	mov	[esp],esi
	mov	eax,esi
	call	_fimageheight
	mov	esi,eax
	mov	eax,[ebp-60]
	cmp	ebx,esi
	mov	eax,ebx
	setl	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-56]
	and	eax,ebx
	and	eax,eax
	jz	_77
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-20]
	add	esi,[ebp-48]
	mov	[esp+4],esi
	mov	eax,[ebp-16]
	add	eax,[ebp-44]
	mov	[esp],eax
	call	_fwritepixelfast
_77
	add	[ebp-48],1
_75
	mov	ebx,[ebp+28]
	sub	ebx,1
	cmp	[ebp-48],ebx
	jle	_76
_17
	add	[ebp-44],1
_73
	mov	ebx,[ebp+24]
	sub	ebx,1
	cmp	[ebp-44],ebx
	jle	_74
_16
	mov	ebx,[ebp+28]
	add	[ebp-20],ebx
_67
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-20],eax
	jle	_66
_13
	mov	ebx,[ebp+24]
	add	[ebp-16],ebx
_65
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_64
_12
	jmp	_52
_52
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_6_leave
	mov	eax,0
	jmp	_6_leave
_6_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 16
	.align	16
_fimage_scanline
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,44
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	mov	[ebp-40],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	mov	eax,[ebp+24]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,1120403456
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	setb	al
	movzx	eax,al
	and	eax,eax
	jz	_78
	mov	[ebp+24],1120403456
	jmp	_79
_78
	mov	eax,[ebp+24]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,0
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	seta	al
	movzx	eax,al
	and	eax,eax
	jz	_80
	mov	[ebp+24],0
_80
_79
	mov	ebx,[ebp+24]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1120403456
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	mov	esi,1065353216
	push	esi
	fld	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	[ebp+24],esi
	cmp	[ebp+28],1
	setnz	al
	movzx	eax,al
	mov	[ebp-44],eax
	cmp	[ebp+28],2
	mov	eax,ebx
	setnz	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-44]
	and	eax,ebx
	and	eax,eax
	jz	_81
	mov	[ebp+28],1
_81
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	ebx,[ebp+28]
	mov	[ebp-12],ebx
	cmp	[ebp-12],2
	jz	_83
	mov	[ebp-16],0
	jmp	_84
_85
	mov	[ebp-20],0
	jmp	_86
_87
	sub	esp,12
	mov	ebx,[ebp-20]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-16]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-24],eax
	mov	ebx,[ebp-24]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-28],ebx
	mov	ebx,[ebp-24]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-32],ebx
	mov	ebx,[ebp-24]
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-36],ebx
	mov	ebx,[ebp-36]
	mov	esi,[ebp-32]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-28]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-20]
	mov	[esp+4],esi
	mov	eax,[ebp-16]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-20],2
_86
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-20],eax
	jle	_87
_23
	add	[ebp-16],1
_84
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_85
_22
	jmp	_82
_83
	mov	[ebp-16],0
	jmp	_88
_89
	mov	[ebp-20],0
	jmp	_90
_91
	sub	esp,12
	mov	ebx,[ebp-20]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-16]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-24],eax
	mov	ebx,[ebp-24]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-28],ebx
	mov	ebx,[ebp-24]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-32],ebx
	mov	ebx,[ebp-24]
	mov	esi,255
	and	ebx,esi
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-36],ebx
	mov	ebx,[ebp-36]
	mov	esi,[ebp-32]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-28]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-20]
	mov	[esp+4],esi
	mov	eax,[ebp-16]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-20],1
_90
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-20],eax
	jle	_91
_21
	add	[ebp-16],2
_88
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_89
_20
	jmp	_82
_82
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_18_leave
	mov	eax,0
	jmp	_18_leave
_18_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 12
	.align	16
_fimage_colourise
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,48
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	mov	[ebp-40],ebx
	mov	[ebp-44],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	mov	ebx,[ebp+24]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	[ebp+24],ebx
	mov	ebx,[ebp+28]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	[ebp+28],ebx
	mov	ebx,[ebp+32]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	[ebp+32],ebx
	cmp	[ebp+36],1
	setnz	al
	movzx	eax,al
	mov	[ebp-48],eax
	cmp	[ebp+36],2
	mov	eax,ebx
	setnz	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-48]
	and	eax,ebx
	and	eax,eax
	jz	_92
	mov	[ebp+36],1
_92
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	[ebp-12],0
	jmp	_93
_94
	mov	[ebp-16],0
	jmp	_95
_96
	sub	esp,12
	mov	ebx,[ebp-16]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-20],eax
	mov	ebx,[ebp-20]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	[ebp-24],ebx
	mov	ebx,[ebp-20]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	[ebp-28],ebx
	mov	ebx,[ebp-20]
	mov	esi,255
	and	ebx,esi
	mov	[ebp-32],ebx
	mov	ebx,1050187929
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	esi,1058444951
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp-28]
	push	edi
	fild	[esp]
	pop	edi
	fmulp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	ebx,esi
	mov	esi,1038147809
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp-32]
	push	edi
	fild	[esp]
	pop	edi
	fmulp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	ebx,esi
	mov	[ebp-36],ebx
	mov	ebx,[ebp+36]
	mov	[ebp-40],ebx
	cmp	[ebp-40],2
	jz	_98
	cmp	[ebp-36],128
	jl	_99
	mov	ebx,1065353216
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fsubp	st(1)
	mov	esi,[ebp-36]
	mov	edi,255
	sub	edi,[ebp-36]
	sub	esi,edi
	push	esi
	fild	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp+24]
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-24],esi
	mov	ebx,1065353216
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fsubp	st(1)
	mov	esi,[ebp-36]
	mov	edi,255
	sub	edi,[ebp-36]
	sub	esi,edi
	push	esi
	fild	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp+28]
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-28],esi
	mov	ebx,1065353216
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp+32]
	push	esi
	fld	[esp]
	pop	esi
	fsubp	st(1)
	mov	esi,[ebp-36]
	mov	edi,255
	sub	edi,[ebp-36]
	sub	esi,edi
	push	esi
	fild	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,[ebp+32]
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-32],esi
	jmp	_100
_99
	mov	ebx,[ebp-36]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	shl	ebx,byte 1
	mov	[ebp-24],ebx
	mov	ebx,[ebp-36]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	shl	ebx,byte 1
	mov	[ebp-28],ebx
	mov	ebx,[ebp-36]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+32]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	shl	ebx,byte 1
	mov	[ebp-32],ebx
_100
	jmp	_97
_98
	mov	ebx,[ebp-36]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-24],ebx
	mov	ebx,[ebp-36]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-28],ebx
	mov	ebx,[ebp-32]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+32]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	[ebp-32],ebx
	jmp	_97
_97
	mov	ebx,[ebp-32]
	mov	esi,[ebp-28]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-24]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-44],ebx
	sub	esp,16
	mov	ebx,[ebp-44]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_95
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_96
_26
	add	[ebp-12],1
_93
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_94
_25
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_24_leave
	mov	eax,0
	jmp	_24_leave
_24_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 20
	.align	16
_fimage_brightness
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,36
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	mov	eax,[ebp+28]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,1120403456
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	setb	al
	movzx	eax,al
	and	eax,eax
	jz	_101
	mov	[ebp+28],1120403456
	jmp	_102
_101
	mov	eax,[ebp+28]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,-1027080192
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	seta	al
	movzx	eax,al
	and	eax,eax
	jz	_103
	mov	[ebp+28],-1027080192
_103
_102
	mov	eax,[ebp+28]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,0
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	setbe	al
	movzx	eax,al
	and	eax,eax
	jz	_104
	mov	ebx,1120534528
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fsubp	st(1)
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fdivrp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	[ebp+28],esi
	jmp	_105
_104
	mov	ebx,[ebp+28]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1112014848
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	mov	esi,0
	push	esi
	fld	[esp]
	pop	esi
	fsubrp	st(1)
	mov	ebx,1120534528
	push	ebx
	fld	[esp]
	pop	ebx
	mov	edi,[ebp+28]
	push	edi
	fld	[esp]
	pop	edi
	fsubp	st(1)
	mov	edi,[ebp+28]
	push	edi
	fld	[esp]
	pop	edi
	fdivrp	st(1)
	fmulp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	[ebp+28],esi
_105
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	[ebp-12],0
	jmp	_106
_107
	mov	[ebp-16],0
	jmp	_108
_109
	sub	esp,12
	mov	ebx,[ebp-16]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-20],eax
	mov	ebx,[ebp-20]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	[ebp-24],ebx
	mov	ebx,[ebp-20]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	[ebp-28],ebx
	mov	ebx,[ebp-20]
	mov	esi,255
	and	ebx,esi
	mov	[ebp-32],ebx
	mov	eax,[ebp+28]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,0
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	setae	al
	movzx	eax,al
	and	eax,eax
	jz	_110
	cmp	[ebp-24],128
	jge	_111
	mov	ebx,127
	sub	ebx,[ebp-24]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-24],esi
	jmp	_112
_111
	mov	ebx,[ebp-24]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-24],esi
_112
	cmp	[ebp-28],128
	jge	_113
	mov	ebx,127
	sub	ebx,[ebp-28]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-28]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-28],esi
	jmp	_114
_113
	mov	ebx,[ebp-28]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-28]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-28],esi
_114
	cmp	[ebp-32],128
	jge	_115
	mov	ebx,127
	sub	ebx,[ebp-32]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-32]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-32],esi
	jmp	_116
_115
	mov	ebx,[ebp-32]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-32]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	add	esi,[ebp+24]
	mov	[ebp-32],esi
_116
	jmp	_117
_110
	cmp	[ebp-24],128
	jge	_118
	mov	ebx,[ebp+24]
	add	[ebp-24],ebx
	mov	ebx,127
	sub	ebx,[ebp-24]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-24],esi
	jmp	_119
_118
	mov	ebx,[ebp+24]
	add	[ebp-24],ebx
	mov	ebx,[ebp-24]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-24]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-24],esi
_119
	cmp	[ebp-28],128
	jge	_120
	mov	ebx,[ebp+24]
	add	[ebp-28],ebx
	mov	ebx,127
	sub	ebx,[ebp-28]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-28]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-28],esi
	jmp	_121
_120
	mov	ebx,[ebp+24]
	add	[ebp-28],ebx
	mov	ebx,[ebp-28]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-28]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-28],esi
_121
	cmp	[ebp-32],128
	jge	_122
	mov	ebx,[ebp+24]
	add	[ebp-32],ebx
	mov	ebx,127
	sub	ebx,[ebp-32]
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-32]
	push	esi
	fild	[esp]
	pop	esi
	fsubrp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-32],esi
	jmp	_123
_122
	mov	ebx,[ebp+24]
	add	[ebp-32],ebx
	mov	ebx,[ebp-32]
	sub	ebx,127
	push	ebx
	fild	[esp]
	pop	ebx
	mov	esi,[ebp+28]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	mov	esi,[ebp-32]
	push	esi
	fild	[esp]
	pop	esi
	faddp	st(1)
	push	esi
	fistp	[esp]
	pop	esi
	mov	[ebp-32],esi
_123
_117
	cmp	[ebp-24],255
	jle	_124
	mov	[ebp-24],255
_124
	cmp	[ebp-24],0
	jge	_125
	mov	[ebp-24],0
_125
	cmp	[ebp-28],255
	jle	_126
	mov	[ebp-28],255
_126
	cmp	[ebp-28],0
	jge	_127
	mov	[ebp-28],0
_127
	cmp	[ebp-32],255
	jle	_128
	mov	[ebp-32],255
_128
	cmp	[ebp-32],0
	jge	_129
	mov	[ebp-32],0
_129
	mov	ebx,[ebp-32]
	mov	esi,[ebp-28]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-24]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-36],ebx
	sub	esp,16
	mov	ebx,[ebp-36]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_108
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_109
_30
	add	[ebp-12],1
_106
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_107
_29
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_28_leave
	mov	eax,0
	jmp	_28_leave
_28_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 12
	.align	16
_fimage_negative
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,36
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	[ebp-12],0
	jmp	_130
_131
	mov	[ebp-16],0
	jmp	_132
_133
	sub	esp,12
	mov	ebx,[ebp-16]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-20],eax
	mov	ebx,[ebp-20]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	esi,255
	sub	esi,ebx
	mov	[ebp-24],esi
	mov	ebx,[ebp-20]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	esi,255
	sub	esi,ebx
	mov	[ebp-28],esi
	mov	ebx,[ebp-20]
	mov	esi,255
	and	ebx,esi
	mov	esi,255
	sub	esi,ebx
	mov	[ebp-32],esi
	mov	ebx,[ebp-32]
	mov	esi,[ebp-28]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-24]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-36],ebx
	sub	esp,16
	mov	ebx,[ebp-36]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_132
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_133
_33
	add	[ebp-12],1
_130
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_131
_32
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_31_leave
	mov	eax,0
	jmp	_31_leave
_31_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 4
	.align	16
_fimage_floyddither
	push	ebx
	push	esi
	push	edi
	push	ebp
	mov	ebp,esp
	sub	esp,56
	mov	ebx,0
	mov	[ebp-4],ebx
	mov	[ebp-8],ebx
	mov	[ebp-12],ebx
	mov	[ebp-16],ebx
	mov	[ebp-20],ebx
	mov	[ebp-24],ebx
	mov	[ebp-28],ebx
	mov	[ebp-32],ebx
	mov	[ebp-36],ebx
	mov	[ebp-40],ebx
	mov	[ebp-44],ebx
	mov	[ebp-48],ebx
	call	_fgraphicsbuffer
	mov	[ebp-4],eax
	sub	esp,4
	mov	eax,[ebp+20]
	mov	[esp],eax
	call	_fcopyimage
	mov	[ebp-8],eax
	sub	esp,4
	mov	eax,_afloydsarray
	mov	[esp],eax
	call	__bbUndimArray
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	mov	ebx,_afloydsarray
	add	ebx,12
	mov	[ebx],eax
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	mov	ebx,_afloydsarray
	add	ebx,16
	mov	[ebx],eax
	sub	esp,4
	mov	eax,_afloydsarray
	mov	[esp],eax
	call	__bbDimArray
	sub	esp,12
	mov	eax,[ebp-8]
	mov	[esp],eax
	mov	[esp+4],0
	call	_fimagebuffer
	mov	[esp],eax
	call	_fsetbuffer
	sub	esp,4
	mov	[esp],0
	call	_flockbuffer
	mov	[ebp-12],0
	jmp	_134
_135
	mov	[ebp-16],0
	jmp	_136
_137
	sub	esp,12
	mov	ebx,[ebp-16]
	mov	[esp+4],ebx
	mov	[esp+8],0
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_freadpixelfast
	mov	ebx,16777215
	and	eax,ebx
	mov	[ebp-20],eax
	mov	ebx,[ebp-20]
	shr	ebx,byte 16
	mov	esi,255
	and	ebx,esi
	mov	[ebp-24],ebx
	mov	ebx,[ebp-20]
	shr	ebx,byte 8
	mov	esi,255
	and	ebx,esi
	mov	[ebp-28],ebx
	mov	ebx,[ebp-20]
	mov	esi,255
	and	ebx,esi
	mov	[ebp-32],ebx
	mov	eax,222
	imul	eax,[ebp-24]
	mov	ebx,707
	imul	ebx,[ebp-28]
	add	eax,ebx
	mov	ebx,71
	imul	ebx,[ebp-32]
	add	eax,ebx
	mov	ecx,1000
	cdq
	idiv	ecx
	push	eax
	fild	[esp]
	pop	eax
	push	eax
	fstp	[esp]
	pop	eax
	mov	[ebp-36],eax
	mov	ebx,[ebp-36]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,1132396544
	push	esi
	fld	[esp]
	pop	esi
	fdivp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	esi,[ebp-16]
	add	esi,[ebp-12]
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	[esi],ebx
	mov	ebx,[ebp-36]
	push	ebx
	fld	[esp]
	pop	ebx
	push	ebx
	fistp	[esp]
	pop	ebx
	mov	esi,[ebp-36]
	push	esi
	fld	[esp]
	pop	esi
	push	esi
	fistp	[esp]
	pop	esi
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp-36]
	push	esi
	fld	[esp]
	pop	esi
	push	esi
	fistp	[esp]
	pop	esi
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_136
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_137
_36
	add	[ebp-12],1
_134
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_135
_35
	mov	[ebp-12],0
	jmp	_138
_139
	mov	[ebp-16],0
	jmp	_140
_141
	mov	eax,_afloydsarray
	add	eax,12
	mov	eax,[eax]
	imul	eax,[ebp-16]
	add	eax,[ebp-12]
	shl	eax,byte 2
	add	eax,[_afloydsarray]
	mov	eax,[eax]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,1056964608
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	seta	al
	movzx	eax,al
	and	eax,eax
	jz	_142
	mov	[ebp-44],0
	jmp	_143
_142
	mov	[ebp-44],1
_143
	mov	ebx,_afloydsarray
	add	ebx,12
	mov	ebx,[ebx]
	imul	ebx,[ebp-16]
	add	ebx,[ebp-12]
	shl	ebx,byte 2
	add	ebx,[_afloydsarray]
	mov	ebx,[ebx]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp-44]
	push	esi
	fild	[esp]
	pop	esi
	fsubp	st(1)
	mov	esi,[ebp+24]
	push	esi
	fld	[esp]
	pop	esi
	fmulp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	[ebp-48],esi
	mov	ebx,[ebp-16]
	add	ebx,1
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	ebx,eax
	jg	_144
	mov	ebx,[ebp-16]
	add	ebx,1
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	ebx,esi
	add	ebx,[ebp-12]
	shl	ebx,byte 2
	add	ebx,[_afloydsarray]
	mov	ebx,[ebx]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp-48]
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,1088421888
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	mov	edi,1098907648
	push	edi
	fld	[esp]
	pop	edi
	fdivp	st(1)
	faddp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	esi,[ebp-16]
	add	esi,1
	mov	edi,_afloydsarray
	add	edi,12
	mov	edi,[edi]
	imul	esi,edi
	add	esi,[ebp-12]
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	[esi],ebx
_144
	mov	ebx,[ebp-16]
	sub	ebx,1
	cmp	ebx,0
	jl	_145
	mov	ebx,[ebp-12]
	add	ebx,1
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	ebx,eax
	jg	_146
	mov	ebx,[ebp-16]
	sub	ebx,1
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	ebx,esi
	mov	esi,[ebp-12]
	add	esi,1
	add	esi,ebx
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	esi,[esi]
	push	esi
	fld	[esp]
	pop	esi
	mov	ebx,[ebp-48]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	edi,1077936128
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	mov	edi,1098907648
	push	edi
	fld	[esp]
	pop	edi
	fdivp	st(1)
	faddp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	ebx,[ebp-16]
	sub	ebx,1
	mov	edi,_afloydsarray
	add	edi,12
	mov	edi,[edi]
	imul	ebx,edi
	mov	edi,[ebp-12]
	add	edi,1
	add	edi,ebx
	shl	edi,byte 2
	add	edi,[_afloydsarray]
	mov	[edi],esi
_146
_145
	mov	ebx,[ebp-12]
	add	ebx,1
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	ebx,eax
	jg	_147
	mov	ebx,[ebp-12]
	add	ebx,1
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	esi,[ebp-16]
	add	ebx,esi
	shl	ebx,byte 2
	add	ebx,[_afloydsarray]
	mov	ebx,[ebx]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	esi,[ebp-48]
	push	esi
	fld	[esp]
	pop	esi
	mov	edi,1084227584
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	mov	edi,1098907648
	push	edi
	fld	[esp]
	pop	edi
	fdivp	st(1)
	faddp	st(1)
	push	ebx
	fstp	[esp]
	pop	ebx
	mov	esi,[ebp-12]
	add	esi,1
	mov	edi,_afloydsarray
	add	edi,12
	mov	edi,[edi]
	imul	edi,[ebp-16]
	add	esi,edi
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	[esi],ebx
_147
	mov	eax,[ebp-12]
	add	eax,1
	mov	[ebp-52],eax
	sub	esp,4
	mov	ebx,[ebp-8]
	mov	[esp],ebx
	mov	eax,ebx
	call	_fimagewidth
	mov	ebx,eax
	mov	eax,[ebp-52]
	sub	ebx,1
	cmp	eax,ebx
	setle	al
	movzx	eax,al
	mov	[ebp-52],eax
	mov	ebx,[ebp-16]
	add	ebx,1
	mov	[ebp-56],eax
	sub	esp,4
	mov	esi,[ebp-8]
	mov	[esp],esi
	mov	eax,esi
	call	_fimageheight
	mov	esi,eax
	mov	eax,[ebp-56]
	sub	esi,1
	cmp	ebx,esi
	mov	eax,ebx
	setle	al
	movzx	eax,al
	mov	ebx,eax
	mov	eax,[ebp-52]
	and	eax,ebx
	and	eax,eax
	jz	_148
	mov	ebx,[ebp-16]
	add	ebx,1
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	ebx,esi
	mov	esi,[ebp-12]
	add	esi,1
	add	esi,ebx
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	esi,[esi]
	push	esi
	fld	[esp]
	pop	esi
	mov	ebx,[ebp-48]
	push	ebx
	fld	[esp]
	pop	ebx
	mov	edi,1065353216
	push	edi
	fld	[esp]
	pop	edi
	fmulp	st(1)
	mov	edi,1098907648
	push	edi
	fld	[esp]
	pop	edi
	fdivp	st(1)
	faddp	st(1)
	push	esi
	fstp	[esp]
	pop	esi
	mov	ebx,[ebp-16]
	add	ebx,1
	mov	edi,_afloydsarray
	add	edi,12
	mov	edi,[edi]
	imul	ebx,edi
	mov	edi,[ebp-12]
	add	edi,1
	add	edi,ebx
	shl	edi,byte 2
	add	edi,[_afloydsarray]
	mov	[edi],esi
_148
	add	[ebp-16],1
_140
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_141
_38
	add	[ebp-12],1
_138
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_139
_37
	mov	[ebp-12],0
	jmp	_149
_150
	mov	[ebp-16],0
	jmp	_151
_152
	mov	eax,_afloydsarray
	add	eax,12
	mov	eax,[eax]
	imul	eax,[ebp-16]
	add	eax,[ebp-12]
	shl	eax,byte 2
	add	eax,[_afloydsarray]
	mov	eax,[eax]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,1065353216
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	setb	al
	movzx	eax,al
	and	eax,eax
	jz	_153
	mov	ebx,1065353216
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	esi,[ebp-16]
	add	esi,[ebp-12]
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	[esi],ebx
	jmp	_154
_153
	mov	eax,_afloydsarray
	add	eax,12
	mov	eax,[eax]
	imul	eax,[ebp-16]
	add	eax,[ebp-12]
	shl	eax,byte 2
	add	eax,[_afloydsarray]
	mov	eax,[eax]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,0
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	seta	al
	movzx	eax,al
	and	eax,eax
	jz	_155
	mov	ebx,0
	mov	esi,_afloydsarray
	add	esi,12
	mov	esi,[esi]
	imul	esi,[ebp-16]
	add	esi,[ebp-12]
	shl	esi,byte 2
	add	esi,[_afloydsarray]
	mov	[esi],ebx
_155
_154
	mov	eax,_afloydsarray
	add	eax,12
	mov	eax,[eax]
	imul	eax,[ebp-16]
	add	eax,[ebp-12]
	shl	eax,byte 2
	add	eax,[_afloydsarray]
	mov	eax,[eax]
	push	eax
	fld	[esp]
	pop	eax
	mov	ebx,1056964608
	push	ebx
	fld	[esp]
	pop	ebx
	fucompp
	fnstsw	ax
	sahf
	seta	al
	movzx	eax,al
	and	eax,eax
	jz	_156
	mov	ebx,[ebp+48]
	mov	esi,[ebp+44]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp+40]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
	jmp	_157
_156
	mov	ebx,[ebp+36]
	mov	esi,[ebp+32]
	shl	esi,byte 8
	or	ebx,esi
	mov	esi,[ebp+28]
	shl	esi,byte 16
	or	ebx,esi
	mov	esi,-16777216
	or	ebx,esi
	mov	[ebp-40],ebx
_157
	sub	esp,16
	mov	ebx,[ebp-40]
	mov	[esp+8],ebx
	mov	[esp+12],0
	mov	esi,[ebp-16]
	mov	[esp+4],esi
	mov	eax,[ebp-12]
	mov	[esp],eax
	call	_fwritepixelfast
	add	[ebp-16],1
_151
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimageheight
	sub	eax,1
	cmp	[ebp-16],eax
	jle	_152
_40
	add	[ebp-12],1
_149
	sub	esp,4
	mov	eax,[ebp-8]
	mov	[esp],eax
	call	_fimagewidth
	sub	eax,1
	cmp	[ebp-12],eax
	jle	_150
_39
	sub	esp,4
	mov	[esp],0
	call	_funlockbuffer
	sub	esp,4
	mov	eax,[ebp-4]
	mov	[esp],eax
	call	_fsetbuffer
	mov	eax,[ebp-8]
	jmp	_34_leave
	mov	eax,0
	jmp	_34_leave
_34_leave
	mov	esp,ebp
	pop	ebp
	pop	edi
	pop	esi
	pop	ebx
	ret	word 32
_41	.db	"Image Functions by Myke-P 2001",0
_42	.db	"",0
	.align	4
_vsourceimage	.dd	0
_43	.db	"TestIn.bmp",0
	.align	4
_vdestinimage	.dd	0
	.align	4
_afloydsarray	.dd	0
	.dd	2
	.dd	2
	.dd	0
	.dd	0
_44	.db	"TestOut.bmp",0
_45	.db	"That took: ",0
_46	.db	" millisecs.",0
	.align	4
__LIBS
	.db	"",0
	.align	4
__DATA
	.dd	0

